<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Manifold | Nikita Mashalov</title> <meta name="author" content="Nikita Mashalov"> <meta name="description" content="Manifold are essential for studying systems that can be observed only locally. Therefore it useful tool for tasks of observation, optimal path finding and generalization of knowledge"> <meta name="keywords" content="Mashalov Nikita, machine learning, artificial intelligence, AI"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%94%AD&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nmashalov.github.io/blog/2024/manifold/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Manifold",
      "description": "Manifold are essential for studying systems that can be observed only locally. Therefore it useful tool for tasks of observation, optimal path finding and   generalization of knowledge",
      "published": "February 23, 2024",
      "authors": [
        {
          "author": "Mashalov Nikita",
          "authorURL": "",
          "affiliations": [
            {
              "name": "MIPT",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Nikita Mashalov</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Manifold</h1> <p>Manifold are essential for studying systems that can be observed only locally. Therefore it useful tool for tasks of observation, optimal path finding and generalization of knowledge</p> </d-title><d-byline></d-byline><d-article> <p>Concept of manifold may seem difficult at first glance, due it’s abstract definition.</p> <h2 id="blind-man-and-elephant">Blind man and elephant</h2> <p>Once upon a time, in a small village nestled between rolling hills and lush forests, there lived six blind men. Each of them was curious and eager to explore the world around them despite their inability to see. One day, they heard tales of a magnificent creature called an elephant that had arrived in their village. Excited to experience something new, they decided to seek out the elephant.</p> <p>With their canes tapping the ground, the blind men made their way to where the elephant was said to be. As they approached, they could feel the ground rumbling beneath their feet, and the air was filled with the sound of trumpeting.</p> <p>The first blind man, reaching out his hands, touched the elephant’s side. “Ah,” he exclaimed, “the elephant is like a sturdy wall, strong and immovable!”</p> <p>The second blind man, feeling the elephant’s trunk, disagreed. “No, it’s not like a wall at all,” he said. “The elephant is long and flexible, like a snake.”</p> <p>The third blind man, holding onto the elephant’s tusk, chimed in, “Neither of you is correct. The elephant is hard and smooth, sharp like a spear.”</p> <p>The fourth blind man, wrapping his arms around one of the elephant’s legs, argued, “You’re all mistaken. The elephant is thick and cylindrical, like a tree trunk.”</p> <p>The fifth blind man, feeling the elephant’s ear, chuckled. “You’re all only partly right,” he said. “The elephant is wide and flat, like a giant fan.”</p> <p>The sixth blind man, who had reached up to touch the elephant’s tail, shook his head. “No, no, no,” he said. “The elephant is thin and wiry, like a rope.”</p> <p>As the blind men continued to discuss and debate what they had felt, a wise old villager passing by overheard their conversation. With a gentle smile, he approached them and said, “My friends, you are all correct in your own way. The elephant is indeed all the things you have described and more. Each of you has touched just one part of the elephant, but none of you can fully comprehend its entirety without considering the perspectives of others.”</p> <p>Realizing the wisdom in the old man’s words, the blind men nodded in understanding. From that day on, they learned to appreciate the value of different perspectives and understood that the truth often lies in the combination of them all. And as they continued their journey through life, they embraced the diversity of experiences and opinions, knowing that it enriched their understanding of the world around them.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/atlas.excalidraw.png" alt="blind_man_elephant.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Rigid body lattice</em></td> </tr> </tbody> </table> <p>So it said, manifold is a mathematical concept with object which can sensed only locally.</p> <h2 id="introduction">Introduction</h2> <p>We’ll start graph, which serves for same goal as manifold in discrete cases. Recall graph is just a collection of edges and</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/graph.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Graph is just a bundle of node and edges</em></td> </tr> </tbody> </table> <p>Due to the one of the most important problems, how to find something. Suppose you are foreign city and you want to find supermarket.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/graph.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Where I can buy food?</em></td> </tr> </tbody> </table> <p>Let’s find out it iteratively by visiting nearest streets. For that we use bread-search algorithm.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/graph.gif" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Depth search by <a href="https://slama.dev/manim/camera-and-graphs/" rel="external nofollow noopener" target="_blank">slama.dev</a>. Flash mean observation. Blue node candidates.</em></td> </tr> </tbody> </table> <p>ou walk from your starting point - home and look around. When you’ll observe supermarket. you’’ build <em>optimal</em> path. In manifold studying it’s called geodesics.</p> <h2 id="elucidating-manifold">Elucidating manifold</h2> <p>Manifold are</p> <p>Edges are named connection and defined via Cristofel $K$ and Levi-Civitia $\nabla$ symbols.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/graph_holds_plane.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Nodes now Euclidian surface, edges Levi-Civitia symbols</em></td> </tr> </tbody> </table> <p>As we understand from discrete representation we need to know to main things, how to measure distance for geodesics. For that we need metric and</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/tangent_space.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Tangent space</em></td> </tr> </tbody> </table> <p>Metric is a way of measuring distance between vectors in tangent space. Most common is just an angle.</p> <p>Locally manifold are just normal euclidian. It’s like graph node stores in it’s state.</p> <h3 id="locally-euclidian">Locally euclidian</h3> <p>Recall that earth was believed to be flat for many ears. It took tremendous time for brightest minds to elucidate from observations, that surface is only locally flat, but in whole spherical</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/earth.excalidraw.png" alt="blind_man_elephant.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center">*Manifolds are locally *</td> </tr> </tbody> </table> <p>For working we use atlases. It’s a whole graph of a world.</p> <p>Graph can be different</p> <h2 id="maps-pushforward-and-pullback">Maps, pushforward and pullback</h2> <p>Yet not all manifold are convenient to work about, some of them are too curly or don’t proper way to measure distance on them.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/representation/net.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Tangent space</em></td> </tr> </tbody> </table> <p>Easiest example is polar coordinate system</p> <p>therefore we can choose a better representation. Something more flat, which allows to better approximate distances and metrics</p> <p>Connection between manifold of studying and better presentation is given map by map $f$.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/representation/net.excalidraw.png" alt="graph.ong"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Tangent space</em></td> </tr> </tbody> </table> <p>We require from this map to be revertible for</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/representation/map.excalidraw.png" alt="map.png"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Smooth map to more flat space</em></td> </tr> </tbody> </table> <p>For translation vector from tangent space we have pushforward transformations</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/representation/pushforward.excalidraw.png" alt="push_forward.png"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Pushforward</em></td> </tr> </tbody> </table> <p>Vector can change significantly after pushforawd operation: rotate and scales.</p> <p>Exact transformation is given via pushforward Jacobian in exact point.</p> \[J = \begin{bmatrix} \frac{\partial u_1}{\partial x_1} &amp; \frac{\partial u_1}{\partial x_2} &amp; \frac{\partial u_1}{\partial x_3} \\[1ex] % &lt;-- 1ex more space between rows of matrix \frac{\partial u_2}{\partial x_1} &amp; \frac{\partial u_2}{\partial x_2} &amp; \frac{\partial u_2}{\partial x_3} \\[1ex] \frac{\partial u_3}{\partial x_1} &amp; \frac{\partial u_3}{\partial x_2} &amp; \frac{\partial u_3}{\partial x_3} \end{bmatrix}\] <p>In manifold studying they will bring atlas. Similarity comes fact.</p> <p>Metric works effectively the same, but map is called pullback.</p> <table> <thead> <tr> <th style="text-align: center"><img src="/assets/img/posts/manifold/representation/pullback.excalidraw.png" alt="push_forward.png"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>Pushforward</em></td> </tr> </tbody> </table> <p>Finally, for metric needed for measuring</p> <h3 id="pushback-properies">Pushback properies</h3> <p>There are some essential properties that we want to preserve</p> <p>When we send structures to like faces we wand them to keep face</p> <p>More formally it’s named called equivariance</p> <p>|<img src="/assets/img/posts/manifold/equivariance.excalidraw.png" alt="equivariance.png"> | |:–:| | *Rotation in both spaces should be seamless. <a href="https://www.youtube.com/watch?v=03MbWVlbefM&amp;t=1393s" rel="external nofollow noopener" target="_blank">Picture link</a> * | Moreover we want to preserve similarity, which comes from angles between vectors. Such transformations are named conformal</p> \[J^T J\] <p>For approxiation of Jacobian we choose sum of eigenvectors with biggest eigenvalues</p> <p>It measures how small changes of one basis affects others. That’s it. Pairwise interaction between basis vectors.</p> <p>We need to choose vectors that preserve correlations between input features.</p> <p>Recall that eigenvectors are vector preserved under transformations</p> \[\] <p>Superficial simmilarity and superposition</p> <p>So than manifold</p> <h2 id="learn-more">Learn more</h2> <ul> <li> <p><a href="https://existenceproofblog.wordpress.com/2017/11/03/manifolds-1/https://existenceproofblog.wordpress.com/2017/11/03/manifolds-1/" rel="external nofollow noopener" target="_blank">An Intuitive Introduction to Manifolds &amp; Topology, Part I</a>. Another introduction from different angle</p> </li> <li> <p>Visit this fun video <a href="https://www.youtube.com/watch?v=EMJsYBD-dNk" rel="external nofollow noopener" target="_blank">[MATH ONLY] Non-Euclidean Therapy for AI Trauma [Analog Archives]</a> to build manifold intuition with exciting story of diffusion net Alice.</p> </li> <li> <p><a href="https://geomstats.github.io/notebooks/00_foundations__introduction_to_geomstats.html" rel="external nofollow noopener" target="_blank">Geomstats</a>. Python library with rigorous introduction to manifold studying</p> </li> <li> <p>The Lie Derivative for Measuring Learned Equivariance https://arxiv.org/abs/2210.02984</p> </li> <li> <p>3-MANIFOLDS, KNOTS, AND HOMOLOGY 3-SPHERES https://ishanina.github.io/Academic%20Projects/3-Manifolds%20Knots%20and%20Homology%203-Spheres%20Junior%20Paper/3-Manifolds_Knots_and_Homology_3-Spheres_Junior_Paper.html</p> </li> </ul> <p>Great seminar on geometric learning <a href="https://www.youtube.com/watch?v=03MbWVlbefM&amp;t=1393s" rel="external nofollow noopener" target="_blank">AMMI Seminar - Geometric Deep Learning and Reinforcement Learning (2021)</a></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Nikita Mashalov. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>