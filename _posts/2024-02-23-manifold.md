---
layout: distill
title: Manifold
description: Manifold are essential for studying systems that can be observed only locally. Therefore it useful tool for tasks of observation, optimal path finding and   generalization of knowledge
authors:
  - name: Mashalov Nikita  
    affiliations: 
      name: MIPT
---
\


## Intuition

Concept of manifold is difficult, due it's abstract mathematical deffinition.

Blind man and elephant

|![blind_man_elephant.ong](/assets/img/posts/manifold/atlas.excalidraw.png) |
|:--:|
| *Rigid body lattice* |

As observer it's hard to judge the earth is approximatelly a sphere. Yet that conjuction is essential for building

So it said, manifold helps to build intuition on surface from it's local observation.

## Introduction

We'll start graph, which serves for same goal as manifold in discrete cases. Recall graph is just a collection of edges and  

|![graph.ong](/assets/img/posts/manifold/graph.excalidraw.png) |
|:--:|
| *Graph is just a bundle of node and edges* |

Due to the one of the most important problems, how to find something. Suppose you are foreign city and you want to find supermarket.

|![graph.ong](/assets/img/posts/manifold/graph.excalidraw.png) |
|:--:|
| *Where I can buy food?* |

Let's find out it iteratively by visiting nearest streets. For that we use bread-search algorithm.

|![graph.ong](/assets/img/posts/manifold/graph.gif) |
|:--:|
| *Depth search by [slama.dev](https://slama.dev/manim/camera-and-graphs/). Flash  mean observation. Blue node candidates.* |

ou walk from your starting point - home and look around. When you'll observe supermarket. you'' build *optimal* path. In manifold studying it's called geodesics.

## Back to manifold


Locally manifold are just normal euclidian. It's like graph node stores in it's state.


Edges are named connection and defined via Cristofel $K$ and Levi-Civitia $\nabla$ symbols.

|![graph.ong](/assets/img/posts/manifold/graph_holds_plane.excalidraw.png) |
|:--:|
| *Nodes now Euclidian surface, edges Levi-Civitia symbols* |

As we understand from discrete representation we need to know to main things, how to measure distance for geodesics. For that   we need metric and

|![graph.ong](/assets/img/posts/manifold/tangent_space.excalidraw.png) |
|:--:|
| *Tangent space* |

Metric is a way of measuring distance between vectors in tangent space. Most common is just an angle.


## Pushworward, pushback and pullback, s

Yet not all manifold are convenient to work about, therefore we can choose a better representation. Something more flat, which allows to better approximate distances and metrics

Connection between manifold of studying and better presentation is given map by map $f$.

|![graph.ong](/assets/img/posts/manifold/representation/net.excalidraw.png) |
|:--:|
| *Tangent space* |

We require from this map to be revertible for

|![map.png](/assets/img/posts/manifold/representation/map.excalidraw.png) |
|:--:|
| *Smooth map to more flat space* |

For translation vector from tangent space we have pushforward transformations

|![push_forward.png](/assets/img/posts/manifold/representation/pushforward.excalidraw.png) |
|:--:|
| *Pushforward* |


Vector can change significantly after pushforawd operation: rotate and scales.

Exact transformation is given via pushforward Jacobian in exact point.

$$
    J = \begin{bmatrix}
    \frac{\partial u_1}{\partial x_1} &
      \frac{\partial u_1}{\partial x_2} &
      \frac{\partial u_1}{\partial x_3} \\[1ex] % <-- 1ex more space between rows of matrix
    \frac{\partial u_2}{\partial x_1} &
      \frac{\partial u_2}{\partial x_2} &
      \frac{\partial u_2}{\partial x_3} \\[1ex]
    \frac{\partial u_3}{\partial x_1} &
      \frac{\partial u_3}{\partial x_2} &
      \frac{\partial u_3}{\partial x_3}
  \end{bmatrix}
$$

In manifold studying they will bring atlas. Similarity comes fact.

Metric works effectively the same, but map is called pullback.

|![push_forward.png](/assets/img/posts/manifold/representation/pullback.excalidraw.png) |
|:--:|
| *Pushforward* |


Finally, for metric needed for measuring

### Pushback properies

There are some essential properties that we want to preserve

When we send structures to like faces we wand them to keep face

More formally it's named called equivariance

|![equivariance.png](/assets/img/posts/manifold/equivariance.excalidraw.png) |
|:--:|
| *Rotation in both spaces should be seamless. [Picture link](https://www.youtube.com/watch?v=03MbWVlbefM&t=1393s) * |
Moreover we want to preserve similarity, which comes from angles between vectors. Such transformations are named conformal

$$
  J^T J 
$$

For approxiation of Jacobian we choose sum of eigenvectors with biggest eigenvalues


It measures how small changes of one basis affects others. That's it. Pairwise interaction between basis vectors.

We need to choose vectors that preserve correlations between input features.

Recall that eigenvectors are preserved under 
$$
  
$$

So 

Superficial simmilarity and superposition

So than manifold

## Learn more

Visit this fun video [[MATH ONLY] Non-Euclidean Therapy for AI Trauma [Analog Archives]](https://www.youtube.com/watch?v=EMJsYBD-dNk) to build manifold intuition with exciting story of diffusion net Alice.

[Geomstats](https://geomstats.github.io/notebooks/00_foundations__introduction_to_geomstats.html). Python library with rigorous introduction to manifold studying

The Lie Derivative for Measuring Learned Equivariance https://arxiv.org/abs/2210.02984


Great seminar on geometric learning
[AMMI Seminar - Geometric Deep Learning and Reinforcement Learning (2021)](https://www.youtube.com/watch?v=03MbWVlbefM&t=1393s)